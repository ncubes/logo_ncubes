to cube :l :p

make "l1 :l
make "llist []

queue "llist :p
while [not :l1=[]] [queue "llist dequeue "l1]
make "l1 :l

queue "llist :p-1
while [not :l1=[]] [queue "llist dequeue "l1]
make "l1 :l

queue "llist :p
while [not :l1=[]] [queue "llist dequeue "l1]
make "l1 :l

queue "llist :p-1
queue "llist dequeue "l1
repeat 2 [queue "llist :p queue "llist :p-1 ]

while [ not :l1=[] ] [
 make "x dequeue "l1 
 if :x=:p-2 
  [ repeat 2 [ queue "llist :p queue "llist :p-1 ] 
    queue "llist :x 
    repeat 2 [ queue "llist :p queue "llist :p-1]] 
 if not  :x=:p-2 [ queue "llist :x]]

end

to cubed :n
setpencolor  :n/2
right 1
fd random 16
setfloodcolor (list random 255 random 255 random 255)
fill
midimessage (list 192   (:varo + :var * :n ) 0)
midimessage (list 144   (50 + :key + :int * :n)   127)
wait  :tempo
midimessage (list 128  (50+ :key + :int * (:n + :sus))   127)
end

to go
show midiopen
show [thinking2]
ncube 2
make "list2 :llist
show :list2
show [thinking4]
ncube 4
make "list4 :llist
show :list4
show [thinking6]
ncube 6
make "list6 :llist
show :list6
show [thinking8]
ncube 8
make "list8 :llist
show :list8
show [thunk!]
play
midiclose
end

to ncube :k
make "k :k-2               ; subtract off the dimension of a square
if :k<0 [stop]             ; check the parameter to be legal
make "llist [2 1 2 1]      ; the line list for a square
make "d 2                  ; number of dimensions in a square
while [ not :k<2] [ make "d :d+2 make "k :k-2 cube :llist :d ] 
End

to off
midiclose
end

to play
make "key random 8 
make "dimen random 4
make "dimen :dimen + 1
make "dimen 2 * :dimen
make "int random 6
make "int :int +1
make "tempo  (random 10) + 10
make "var random  round (128 / :dimen)
make "varo random :var
make "sus random 4
make "sus :sus - 2
make "sus 0
make "pens random 100
setpensize (list :pens :pens)
if :dimen=2 [make "thelist :list2]
if :dimen=4 [make "thelist :list4]
if :dimen=6 [make "thelist :list6]
if :dimen=8 [make "thelist :list8]
while [ not :thelist = [] ] [ cubed (dequeue "thelist) ] 
play
end

Make "a 2
Make "b 2
Make "count 24576
Make "d 8
Make "dimen 8
Make "int 2
Make "k 4
Make "key 4
Make "l [2 1 2 1]
Make "l1 []
Make "l2 [8 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 7 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 8 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 7 6 8 7 8 7 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 8 7 8 7 6 8 7 8 7 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 2 1 2 1 3 2 1 2 1 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 2 1 2 1 3 2 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 1 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 2 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 1]
Make "list []
Make "list2 [2 1 2 1]
Make "list4 [4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1]
Make "list6 [6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1]
Make "list8 [8 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 7 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 8 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 7 6 8 7 8 7 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 8 7 8 7 6 8 7 8 7 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 2 1 2 1 3 2 1 2 1 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 2 1 2 1 3 2 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 1 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 2 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 1]
Make "llist [8 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 7 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 8 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 7 6 8 7 8 7 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 8 7 8 7 6 8 7 8 7 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 2 1 2 1 3 2 1 2 1 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 2 1 2 1 3 2 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 1 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 2 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 1]
Make "m 4
Make "n 6
Make "oldn 1
Make "pens 32
Make "song []
Make "sus 0
Make "tempo 17
Make "thelist [5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 7 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 8 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 6 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 6 5 6 5 2 1 2 1 3 2 1 2 1 6 5 6 5 4 6 5 6 5 2 1 2 1 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 2 6 5 6 5 4 6 5 6 5 3 6 5 6 5 4 6 5 6 5 3 1 7 6 8 7 8 7 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 8 7 8 7 6 8 7 8 7 4 2 1 2 1 3 2 1 2 1 4 2 1 2 1 3 2 4 3 4 3 1 4 3 4 3 2 4 3 4 3 1 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 2 1 2 1 3 2 1 2 1 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 2 1 2 1 3 2 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 1 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 2 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 4 8 7 8 7 6 8 7 8 7 5 8 7 8 7 6 8 7 8 7 5 3 1]
Make "var 8
Make "varo 6
Make "x 1
Make "xd 2
Make "xllist [1 2 1]
Make "xt 2
